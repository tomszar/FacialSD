---
title: Descriptive statistics
output:
  html_document: default
---

In this section we will look at descriptive statistics from covariates, and from the face PCA.
Note that the face PCA was already produced in the matlab jupyter notebook, so any adjustment to the face PCA must be done there.

## Preliminaries

We will load the necessary libraries, and databases

```{r libraries data, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(GGally)
library(ggpubr)
library(psych)
library(ggjoy)
setwd('..')
path <- getwd()
setwd(paste(path, "/Results/PCA", sep = ""))
coeffs   <- read.csv("coeffs.csv")
eigenvec <- read.csv("eigenvectors.csv", header=F)
eigenval <- read.csv("eigenvalues.csv", header=F)
means    <- read.csv("means.csv", header=F)
facets   <- read.csv("facets.csv", header=F)
```

## Data cleaning

For data cleaning, we will remove every individual that is neither Male or Female, and individuals with NAs in any variable (Height, Weight, and Age)

```{r data cleaning}
coeffs <- filter(coeffs, Sex == 'Female' | Sex == 'Male')
coeffs <- droplevels(coeffs)
coeffs <- na.omit(coeffs)
dim(coeffs)
head(coeffs[,1:8])
```

After cleaning, we end up with `r nrow(coeffs)` individuals

# Descriptive stats

We can look at summary statistics

```{r summary}
summary(coeffs[,2:5])
```

As well as summary statistics grouped by sex, where we can see differences in height and weight.

```{r summary by sex}
describeBy(coeffs[,3:5], coeffs$Sex)
```

We can also explore some correlograms

```{r correlogram, fig.height = 8, fig.width = 12, fig.align = "center", message=FALSE}
p1 <- ggpairs(coeffs, columns = 2:7, ggplot2::aes(colour=Sex, alpha = 0.1), 
              lower = list(continuous = "smooth")) + theme_pubr()
p1
```

We can use joy plots to compare the distributions of each PC grouped by sex.
Note that I'll use the mahalanobis space instead of the euclidean one.

```{r joyplots, fig.height = 10, fig.width = 8, fig.align = "center", message=FALSE}
source("PlotPCs.R")
ts <- as.data.frame(scale(coeffs[,6:92]))
p1 <- PlotPCs(ts, coeffs$Sex ,"PC1", "PC9")
p2 <- PlotPCs(ts, coeffs$Sex, "PC10", "PC19")
p3 <- PlotPCs(ts, coeffs$Sex, "PC20", "PC29")
p4 <- PlotPCs(ts, coeffs$Sex, "PC30", "PC39")
ggarrange(p1, p2, p3, p4,
          common.legend = T, legend = "bottom")

p1 <- PlotPCs(ts, coeffs$Sex, "PC40", "PC49")
p2 <- PlotPCs(ts, coeffs$Sex, "PC50", "PC59")
p3 <- PlotPCs(ts, coeffs$Sex, "PC60", "PC69")
p4 <- PlotPCs(ts, coeffs$Sex, "PC70", "PC79")
ggarrange(p1, p2, p3, p4, 
          common.legend = T, legend = "bottom")
```

