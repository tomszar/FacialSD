--
title: Iterative comparison
output: 
  html_document: default
---

## Summary

In this script, we will analyze differences in patterns of FSD using an iterative procedure. 
Using mahalanobis distances between individuals from the genetic PCA as a proxy for genetic distances, we will construct a dendogram.
Using a custom height to generate an initial set of clusters of individuals, we will test for pairwise differences in pattern of morphological change. 
If there is no significant difference, we will group the two clusters together. 
We will repeat this procedure until the clusters are all significantly different in terms of patterns of FSD.

## Preliminaries

```{r preliminaries, message = FALSE}
library(HDMD)
library(biotools)

setwd('..')
path <- getwd()
setwd(paste(path, "/Results/MergedData", sep = ""))
load("MergedDat.RData")

gendist <- D2.dist(MergedDat[[3]][,1:10], cov(MergedDat[[3]][,1:10]))
attributes(gendist)$Labels <- as.character(MergedDat[[1]]$IID)
t <- hclust(gendist)
cut <- cutree(t, h = 100)
summary(as.factor(cut))

```

```{r}
is1 <- cut == 1
is2 <- cut == 2

model1 <- lm(as.matrix(MergedDat[[2]][is1,1:10]) ~ MergedDat[[1]]$Sex[is1] + 
               MergedDat[[1]]$Weight[is1] + MergedDat[[1]]$Height[is1])

model2 <- lm(as.matrix(MergedDat[[2]][is2,1:10]) ~ MergedDat[[1]]$Sex[is2] + 
               MergedDat[[1]]$Weight[is2] + MergedDat[[1]]$Height[is2])


```

